<!DOCTYPE html>
<html>
<head>
  <title>Items in <%= category_name %></title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background-color: #f5f5f5;
    }
    h1 {
      margin-bottom: 10px;
    }
    .item {
      background: white;
      padding: 15px;
      margin-bottom: 10px;
      border-left: 4px solid #007bff;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .buttons a, .buttons button {
      margin-right: 10px;
      display: inline-block;
    }
    .buttons button {
      background: crimson;
      color: white;
      border: none;
      padding: 6px 12px;
      border-radius: 4px;
      cursor: pointer;
    }
    .pagination a {
      margin: 5px;
      text-decoration: none;
    }
  </style>
</head>
<body>
  <h1>📦 Items in "<%= category_name %>"</h1>

  <a href="/category/<%= category_id %>/items/new">➕ Add New Item</a> |
  <a href="/categories">← Back to Categories</a>

  <% if (items.length === 0) { %>
    <p>No items found in this category.</p>
  <% } else { %>
    <% items.forEach(item => { %>
      <div class="item" id="item-<%= item.item_id %>">
        <h3><%= item.item_name %></h3>
        <p><strong>Description:</strong> <%= item.item_description %></p>
        <p><strong>Quantity:</strong> <%= item.item_quantity %></p>
        <div class="buttons">
          <a href="/category/<%= category_id %>/items/<%= item.item_id %>">🔍 View</a>
          <a href="/category/<%= category_id %>/items/<%= item.item_id %>/edit">✏️ Edit</a>
          <button onclick="deleteItem('<%= item.item_id %>', '<%= category_id %>')">🗑️ Delete</button>

        </div>
      </div>
    <% }) %>
  <% } %>

  <div class="pagination">
    <% for (let i = 1; i <= totalPages; i++) { %>
      <% if (i === page) { %>
        <strong><%= i %></strong>
      <% } else { %>
        <a href="/category/<%= category_id %>/items?page=<%= i %>">Page:<%= i %></a>
      <% } %>
    <% } %>
  </div>

  <script>
   function deleteItem(itemId, categoryId) {
  if (confirm("Are you sure you want to delete this item?")) {
    fetch(`/category/${categoryId}/items/${itemId}`, {
      method: "DELETE"
    }).then(res => {
      if (res.status === 204) {
        const itemDiv = document.getElementById(`item-${itemId}`);
        if (itemDiv) {
          itemDiv.remove();
        }
      } else {
        alert("Failed to delete item.");
      }
    }).catch(err => {
      console.error(err);
      alert("Something went wrong while deleting.");
    });
  }
}

  </script>
</body>
</html>
